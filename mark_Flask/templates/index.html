<!DOCTYPE html>
<html>
<head>
    <title>Mod1</title>
    <script src="static/webcam.js"></script>
    <script src="static/jquery-3.5.1.js"></script>
    <script src="static/jquery.redirect.js"></script>
</head>
<body>

<div id="my_camera" style="width:200px; height:200px;"></div>
<div id="my_result"></div>

<script language="JavaScript">
    Webcam.set({
        width: 320,
        height: 240,
        image_format: 'jpeg',
        jpeg_quality: 90,
        crop_width: 200,
        crop_height: 200
    });
    Webcam.attach('#my_camera');

    function take_snapshot() {
        Webcam.snap(function (data_uri) {
            document.getElementById('my_result').innerHTML = '<img src="' + data_uri + '"/>';
            const predictURL = '/image'
            const sendPkg = {
                imgBase64: `${data_uri}`
            };

            var request = $.ajax({
                type: "POST",
                url: predictURL,
                data: JSON.stringify(sendPkg),
                contentType: "application/json",
                statusCode: {
                    200: () => console.log('ajax call receives response')
                },
            });

            request.done(function (resp) {
                console.log(`receive msg from server ${resp.response}`);
            });

            request.fail(function (jqXHR, textStatus) {
                console.log(`Request failed: " + ${textStatus}`);
            });

        });
    }
</script>

<a href="javascript:void(take_snapshot())">Take Snapshot</a>
<p hidden>{{ prediction }}</p>
</body>
</html>